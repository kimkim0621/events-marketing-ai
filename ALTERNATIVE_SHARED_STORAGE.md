# ğŸ”„ ä»£æ›¿æ¡ˆï¼šGoogle Sheets ã§ç°¡å˜å…±æœ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

## ğŸ¯ æ¦‚è¦
Supabaseã®è¨­å®šãŒè¤‡é›‘ãªå ´åˆã€Google Sheetsã‚’ä½¿ã£ãŸç°¡å˜ãªå…±æœ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

## âœ… ãƒ¡ãƒªãƒƒãƒˆ
- âœ… **è¨­å®šãŒè¶…ç°¡å˜**ï¼ˆ5åˆ†ã§å®Œäº†ï¼‰
- âœ… **ç„¡æ–™**ã§ä½¿ç”¨å¯èƒ½
- âœ… **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å…±æœ‰**
- âœ… **ãƒ–ãƒ©ã‚¦ã‚¶ã§ç›´æ¥ç·¨é›†**å¯èƒ½
- âœ… **éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã‚‚ä½¿ã„ã‚„ã™ã„**
- âœ… **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‹•**

## ğŸ“‹ è¨­å®šæ‰‹é †

### 1. Google Sheetsã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ

#### A. æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
1. https://sheets.google.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œ+ æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. åå‰ã‚’ã€Œã‚¤ãƒ™ãƒ³ãƒˆé›†å®¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ã«å¤‰æ›´

#### B. ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆæ§‹æˆ
ä»¥ä¸‹ã®4ã¤ã®ã‚·ãƒ¼ãƒˆã‚’ä½œæˆï¼š

**Sheet 1: ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿç¸¾**
```
| ID | ã‚¤ãƒ™ãƒ³ãƒˆå | ãƒ†ãƒ¼ãƒ | ã‚«ãƒ†ã‚´ãƒª | ç›®æ¨™ç”³è¾¼æ•° | å®Ÿéš›ç”³è¾¼æ•° | äºˆç®— | å®Ÿéš›ã‚³ã‚¹ãƒˆ | é–‹å‚¬æ—¥ | ä½œæˆè€… |
|----|-----------|-------|----------|------------|------------|------|------------|--------|--------|
| 1  | AI Summit | AIæŠ€è¡“ | ã‚»ãƒŸãƒŠãƒ¼ | 100        | 85         | 500000 | 450000   | 2025-01-15 | ç”°ä¸­ |
```

**Sheet 2: ãƒ¡ãƒ‡ã‚£ã‚¢æƒ…å ±**
```
| ID | ãƒ¡ãƒ‡ã‚£ã‚¢å | ç¨®åˆ¥ | æ–™é‡‘ | æƒ³å®šãƒªãƒ¼ãƒ | æƒ³å®šCTR | æƒ³å®šCVR | èª¬æ˜ | ä½œæˆè€… |
|----|-----------|------|------|-----------|---------|---------|------|--------|
| 1  | TechCrunch | ãƒ¡ãƒ‡ã‚£ã‚¢ | 100000 | 50000 | 0.02 | 0.05 | æŠ€è¡“ç³»ãƒ¡ãƒ‡ã‚£ã‚¢ | ä½è—¤ |
```

**Sheet 3: ç”³è¾¼è€…æƒ…å ±**
```
| ID | ã‚¤ãƒ™ãƒ³ãƒˆID | è·ç¨® | å½¹è· | ä¼æ¥­å | æ¥­ç•Œ | å¾“æ¥­å“¡è¦æ¨¡ | ç”³è¾¼çµŒè·¯ | ç”³è¾¼æ—¥ |
|----|-----------|------|------|--------|------|-----------|---------|--------|
| 1  | 1         | ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ | ãƒªãƒ¼ãƒ€ãƒ¼ | ABCç¤¾ | IT | 101-300å | ãƒ¡ãƒ‡ã‚£ã‚¢ | 2025-01-10 |
```

**Sheet 4: çŸ¥è¦‹ãƒ‡ãƒ¼ã‚¿**
```
| ID | ã‚¿ã‚¤ãƒˆãƒ« | å†…å®¹ | ã‚«ãƒ†ã‚´ãƒª | ã‚¿ã‚° | ä½œæˆè€… | ä½œæˆæ—¥ |
|----|----------|------|----------|------|--------|--------|
| 1  | ãƒ¡ãƒ‡ã‚£ã‚¢åŠ¹æœ | TechCrunchã¯åŠ¹æœãŒé«˜ã„ | ãƒ¡ãƒ‡ã‚£ã‚¢ | åŠ¹æœ,å®Ÿç¸¾ | ç”°ä¸­ | 2025-01-01 |
```

### 2. å…±æœ‰è¨­å®š

1. **å³ä¸Šã®ã€Œå…±æœ‰ã€ãƒœã‚¿ãƒ³**ã‚’ã‚¯ãƒªãƒƒã‚¯
2. **ã€Œãƒªãƒ³ã‚¯ã‚’çŸ¥ã£ã¦ã„ã‚‹å…¨å“¡ã€**ã«è¨­å®š
3. **ã€Œç·¨é›†è€…ã€**æ¨©é™ã‚’ä»˜ä¸
4. **å…±æœ‰ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼**ã—ã¦ãƒãƒ¼ãƒ ã«é€ä¿¡

### 3. Google Sheets APIè¨­å®šï¼ˆã‚¢ãƒ—ãƒªé€£æºç”¨ï¼‰

#### A. Google Cloud Consoleã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
1. https://console.cloud.google.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼šã€Œevent-marketing-aiã€
3. **Google Sheets API**ã‚’æœ‰åŠ¹åŒ–
4. **ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ã‚’ä½œæˆ
5. **JSONã‚­ãƒ¼**ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

#### B. Sheets APIã‚¢ã‚¯ã‚»ã‚¹è¨­å®š
```python
# requirements.txt ã«è¿½åŠ 
google-auth==2.17.3
google-auth-oauthlib==1.0.0
google-auth-httplib2==0.2.0
google-api-python-client==2.88.0
gspread==5.9.0
```

## ğŸ› ï¸ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã®å®Ÿè£…

### Google Sheetsé€£æºã‚¯ãƒ©ã‚¹
```python
import gspread
from google.oauth2.service_account import Credentials
import pandas as pd
import streamlit as st

class GoogleSheetsDatabase:
    def __init__(self):
        # ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã§èªè¨¼
        scope = ['https://spreadsheets.google.com/feeds',
                'https://www.googleapis.com/auth/drive']
        
        # secrets.tomlã‹ã‚‰èªè¨¼æƒ…å ±å–å¾—
        creds_dict = st.secrets["google_sheets"]
        creds = Credentials.from_service_account_info(creds_dict, scopes=scope)
        self.client = gspread.authorize(creds)
        
        # ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã
        self.sheet = self.client.open("ã‚¤ãƒ™ãƒ³ãƒˆé›†å®¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹")
    
    def get_events(self):
        """ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—"""
        worksheet = self.sheet.worksheet("ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿç¸¾")
        data = worksheet.get_all_records()
        return pd.DataFrame(data)
    
    def add_event(self, event_data):
        """æ–°ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ """
        worksheet = self.sheet.worksheet("ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿç¸¾")
        row = [
            len(worksheet.get_all_records()) + 1,  # ID
            event_data['event_name'],
            event_data['theme'],
            event_data['category'],
            event_data['target_attendees'],
            event_data['actual_attendees'],
            event_data['budget'],
            event_data['actual_cost'],
            event_data['event_date'],
            event_data['created_by']
        ]
        worksheet.append_row(row)
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```toml
# .streamlit/secrets.toml
[google_sheets]
type = "service_account"
project_id = "your-project-id"
private_key_id = "key-id"
private_key = "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
client_email = "your-service-account@your-project.iam.gserviceaccount.com"
client_id = "client-id"
auth_uri = "https://accounts.google.com/o/oauth2/auth"
token_uri = "https://oauth2.googleapis.com/token"
```

## ğŸ“Š ä½¿ç”¨æ–¹æ³•

### 1. æ‰‹å‹•ã§ã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›
- **Google Sheetsã§ç›´æ¥ç·¨é›†**
- **ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ãŒåŒæ™‚ç·¨é›†å¯èƒ½**
- **å¤‰æ›´å±¥æ­´ãŒè‡ªå‹•ä¿å­˜**

### 2. ã‚¢ãƒ—ãƒªã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹
```python
# Streamlitã‚¢ãƒ—ãƒªã§ã®ä½¿ç”¨ä¾‹
@st.cache_data
def load_shared_data():
    db = GoogleSheetsDatabase()
    events = db.get_events()
    return events

# ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
st.title("ğŸ“Š å…±æœ‰ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿")
events_df = load_shared_data()
st.dataframe(events_df)
```

## ğŸ‰ **ã“ã®æ–¹æ³•ã®ç‰¹å¾´**

### âœ… **è‰¯ã„ç‚¹**
- è¨­å®šãŒç°¡å˜ï¼ˆ30åˆ†ã§å®Œäº†ï¼‰
- éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã‚‚ç›´æ¥ç·¨é›†å¯èƒ½
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ
- ç„¡æ–™ã§ä½¿ç”¨å¯èƒ½
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒè‡ªå‹•
- æ¨©é™ç®¡ç†ãŒç°¡å˜

### âš ï¸ **åˆ¶é™äº‹é …**
- å¤§é‡ãƒ‡ãƒ¼ã‚¿ã«ã¯ä¸å‘ãï¼ˆ1000è¡Œç¨‹åº¦ã¾ã§ï¼‰
- è¤‡é›‘ãªã‚¯ã‚¨ãƒªã¯é›£ã—ã„
- ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãªæ“ä½œãŒé™å®šçš„

## ğŸš€ **å®Ÿè£…åˆ¤æ–­**

**Google Sheetsã‚’é¸ã¶ã¹ãå ´åˆï¼š**
- ãƒãƒ¼ãƒ ãŒ5äººä»¥ä¸‹
- ãƒ‡ãƒ¼ã‚¿é‡ãŒå°‘ãªã„ï¼ˆæœˆ100ä»¶ç¨‹åº¦ï¼‰
- éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒå¤šã„
- ç°¡å˜ã«å§‹ã‚ãŸã„

**Supabaseã‚’é¸ã¶ã¹ãå ´åˆï¼š**
- ãƒãƒ¼ãƒ ãŒå¤§ãã„
- ãƒ‡ãƒ¼ã‚¿é‡ãŒå¤šã„
- è¤‡é›‘ãªåˆ†æãŒå¿…è¦
- é•·æœŸçš„ãªé‹ç”¨ã‚’è€ƒãˆã¦ã„ã‚‹

## ğŸ’¡ **ã©ã¡ã‚‰ãŒãŠã™ã™ã‚ï¼Ÿ**

**åˆæœŸæ®µéš**ã§ã¯**Google Sheets**ã‹ã‚‰å§‹ã‚ã¦ã€**ãƒ‡ãƒ¼ã‚¿ãŒå¢—ãˆã¦ããŸã‚‰Supabase**ã«ç§»è¡Œã™ã‚‹ã®ãŒå®Ÿç”¨çš„ã§ã™ã€‚

ã©ã¡ã‚‰ã®æ–¹æ³•ã§é€²ã‚ãŸã„ã§ã™ã‹ï¼Ÿ 